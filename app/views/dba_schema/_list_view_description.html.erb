<% @update_area = get_unique_area_id %>

<%
column_options =
  [
    {:caption=> 'Created',          :data=>proc{|rec| localeDateTime(rec.created)},          :title=> 'Timestamp of object creation'},
    {:caption=> 'Last DDL',         :data=>proc{|rec| localeDateTime(rec.last_ddl_time)},    :title=> 'Timestamp of last DDL operation on object'},
    { caption: 'Spec. TS',          data: proc{|rec| localeDateTime(rec.spec_ts)},           title: "Timestamp for the last specification change of the object" },
    {:caption=> 'Status',           :data=>proc{|rec| rec.status},                           :title=> 'Status of object in DBA_Objects'},
]

%>

<%= gen_slickgrid(@attribs, column_options, {:caption => "Description of #{@object_type} #{@owner}.#{@object_name}", :height => :auto, show_pin_icon: 1}) %>


<%=  render_code_mirror(@view.text, cm_options: { lineNumbers: true}) %>

<div class="flex-row-container">
  <div class="flex-row-element">
    <%= ajax_submit("#{@dependencies} Dependencies", {
        :update_area  => @update_area,
        :action       => :list_dependencies,
        :owner        => @owner,
        :object_name  => @object_name,
        :object_type  => @object_type
    }, :title => "Show object dependencies for #{@object_type} #{@owner}.#{@table_name}")
    %>
  </div>
  <div class="flex-row-element">
    <%= ajax_submit("#{@grants} Grants", {
        :update_area => @update_area,
        :action      => :list_grants,
        :owner       => @owner,
        :object_name => @object_name
    }, :title => "Show grants for #{@object_type} #{@owner}.#{@object_name}")
    %>
  </div>

  <div class="flex-row-element">
    <%= ajax_submit('DBMS_METADATA', {
      :update_area => @update_area,
      :action      => :list_dbms_metadata_get_ddl,
      :owner       => @owner,
      :table_name  => @object_name,
      :object_type => @object_type
    }, :title => "Show DDL create statement for #{@owner}.#{@object_name} generated by DBMS_METADATA.GET_DDL")
    %>
  </div>

  <div class="flex-row-element">
    <%= ajax_submit("SQLs by plan", {
        update_area:  @update_area,
        controller:   :dba_sga,
        action:       :show_using_sqls,
        ObjectOwner:  @owner,
        ObjectName:   @object_name
    }, :title => "Show SQLs for #{@object_type} #{@owner}.#{@object_name} with view explicitely used in execution plan (not resolved)")
    %>
  </div>
</div>

<div id="<%= @update_area %>"></div>
