<%=
  @update_area = get_unique_area_id
  column_options =
    [
      {caption: 'Owner',            data: proc{|rec| rec.policy_owner},           title: 'Owner of the policy'},
      {caption: 'Name',             data: proc{|rec| rec.policy_name},            title: 'Name of the policy'},
      {caption: 'Text',             data: proc{|rec| rec.policy_text},            title: 'Audit condition'},
      {caption: 'Column',           data: proc{|rec| rec.policy_column},          title: 'Relevant column'},
      {caption: 'Handler schema',   data: proc{|rec| rec.pf_schema},              title: 'Owner of the audit handler function'},
      {caption: 'Handler package',  data: proc{|rec| rec.pf_package},             title: 'Name of the package containing the audit handler function'},
      {caption: 'Handler function', data: proc{|rec| rec.pf_function},            title: 'Name of the audit handler function'},
      {caption: 'Enbl.',            data: proc{|rec| rec.enabled},                title: 'Indicates whether the policy is enabled (YES) or disabled (NO)'},
      {caption: 'Sel.',             data: proc{|rec| rec.sel},                    title: 'Indicates whether the policy is applied to queries on the object (YES) or not (NO)'},
      {caption: 'Ins.',             data: proc{|rec| rec.ins},                    title: 'Indicates whether the policy is applied to INSERT statements on the object (YES) or not (NO)'},
      {caption: 'Upd.',             data: proc{|rec| rec.upd},                    title: 'Indicates whether the policy is applied to UPDATE statements on the object (YES) or not (NO)'},
      {caption: 'Del.',             data: proc{|rec| rec.del},                    title: 'Indicates whether the policy is applied to DELETE statements on the object (YES) or not (NO)'},
      {caption: 'Audit trail',      data: proc{|rec| rec.audit_trail},            title: "Indicates the audit trail to which the audit records generated by this audit policy will be written:\nDB - Audit records are written to DBA_FGA_AUDIT_TRAIL (fine-grained audit trail)\nDB+EXTENDED - Audit records are written to DBA_FGA_AUDIT_TRAIL (fine-grained audit trail) and the SQL_TEXT and SQL_BIND columns are populated for this policy\nXML - Audit records are written to V$XML_AUDIT_TRAIL (XML audit files)\nXML+EXTENDED - Audit records are written to V$XML_AUDIT_TRAIL (XML audit files) and the SQL_TEXT and SQL_BIND columns are populated for this policy"},
      {caption: 'Column options',   data: proc{|rec| rec.policy_column_options},  title: "Indicates whether all columns in the AUDIT_COLUMN parameter\n(ALL_COLUMNS) or any of the columns in the AUDIT_COLUMN parameter\n(ANY_COLUMNS) are considered for triggering fine-grained auditing"},
    ]
  column_options << {caption: 'Common',           data: proc{|rec| rec.common},                 title: "Indicates whether the policy applies across multiple containers (YES) or not (NO)"}   if get_db_version >= '12.2'
  column_options << {caption: 'Inherited',        data: proc{|rec| rec.inherited},              title: "Indicates whether the policy was inherited from another container (YES) or not (NO)"} if get_db_version >= '12.2'

  if @policies.count > 0
    gen_slickgrid(@policies, column_options, {
      :caption => "FGA policies from DBA_Audit_Policies for #{@owner}.#{@object_name}",
      :max_height => 450, show_pin_icon: 1
    })
  else
    ''
  end
%>


<div id="<%= @update_area %>"></div>