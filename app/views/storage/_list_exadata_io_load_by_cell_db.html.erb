<%
  @update_area = get_unique_area_id

  column_options =
    [
      { caption: 'Start time',                data: proc{|rec| localeDateTime(rec.begin_interval_time)},    title: 'Start of considered AWR period', data_title: proc{|rec| "%t: End of considered AWR period = #{localeDateTime(rec.end_interval_time)}" }, :plot_master_time=>true },
    ]

  exadata_cell_db_columns.each do |key, col|
    column =  { caption: col[:caption], data: proc{|rec| fn(rec[key.to_s], col[:scale] || 0)}, title: col[:title], align: :right }
    column[:data_title] = proc{|rec| "%t\n\n#{size_explain(rec[key.to_s])}" } if col[:size_explain]
    column_options << column
  end


  caption = "Exadata cell server I/O load from #{PanoramaConnection.adjust_table_name('DBA_Hist_Cell_DB')}"
  filter = []
  filter << " cell server hash = #{@cell_hash}" if @cell_hash > 0
  filter << " source DBID = #{@src_dbid}"       if @src_dbid > 0
  caption << " for" unless filter.empty?
  caption << filter.join(' and ')
%>

<%=
  gen_slickgrid(@metrics, column_options, { caption: caption,
                                            max_height: 450,
                                            show_pin_icon: 1,
                                            update_area:   @update_area
  })
%>

